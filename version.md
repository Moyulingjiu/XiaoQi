# 版本信息

## 正式发布版本

### 小柒 1.0.0

（暂无）

## 实验版本


| 版本 | 完成内容                                                     |
| :--- | ------------------------------------------------------------ |
| 0    | 实验mirai框架的各种API                                       |
| 1    | 独立数据与代码，将小柒的状态保存在文件中                     |
| 2    | 调整数据的保存方式。引入并完成打卡与大部分基础功能，并且接入神经网络，引入bot_remind部分，实现定时消息提醒。划分小柒的鉴权机构，形成管理操作的雏形。 |
| 3    | 版本3基本上是对版本2的完善与处理。包括各种约束条件，各种文案的调整，以及限制措施，安全保护措施，鉴权措施的完善（将原先两级权限扩展为三级），天气查询支持所有地级市。只引入了几个功能四六级单词、活动管理、基础管理指令、基础骰娘功能。 |
| 4    | 支持图片的发送，引入文字rpg游戏（一系列类似于装备、商店、背包、pvp、合成、分解、单人刷材料等多个机制系统），根据coc第7版规则书完善了部分骰娘功能。 |
| 5    | 去除原先臃肿的事件相应回复机制，进行一个类的统一管理。       |
| 6    | 因为框架的不更新，于是换了一个框架。预计主要调整骰娘部分，维持RPG游戏的更新 |



### 版本6

#### 0.6.11

1.  RPG游戏部分平衡性调整
2. 怪物数据部分平衡性调整
3. 因为部分设计问题，移除天灾军团
4. 新增部分物品
5. 修复RPG游戏部分bug
6. 新增“传送”指令



#### 0.6.10

1. 新增14张地图
   1. 6张新元素地图
   2. 2张资源图
   3. 2张元素混乱地带
   4. 4张新手村深处
2. 优化部落爬取算法
3. 新增PVP逻辑《袭击》，可以血量换取血量
4. 新增生活职业、附魔等级
5. 新增部分装备、技能
6. 新增装备穿戴限制，装备只有指定职业才能穿戴。
7. RPG游戏平衡性调整
8. 部分文案调整
9. 修复卡0不死亡的bug
10. 修复商店购买失败消耗限购次数的bug
11. 修复部分已知小bug
12. 修改技能商店的购买逻辑



#### 0.6.9

1. 增加重置运势的接口

2. 部分代码格式化

3. 修改部分文案

4. 新增指令隧穿的功能

5. 新增复制群回复

6. 修复如果没有添加过复杂回复则无法查看复杂回复的bug

7. 游戏新增强制锁、重载游戏数据的功能

8. 新增驱魔

9. 新增固定时间发放排行榜奖励

   

#### 0.6.8

1. RPG游戏大更新
   1. 修复培育失败物品消失的bug
   2. 修复名字乱跳的bug
   3. 修复群系出现错乱的自我恢复机制的bug
   4. 新增技能
   5. 新增活动、活动兑换
   6. 新增职业等级
   7. 新增附魔等级
   8. 新增装备、地图、合成路线
2. 新增放撤回功能
3. 修复部落只能查询默认部落
4. 修复打卡报错
5. 修复申请权限功能
6. 新增部分部落查询语句
7. 新增漂流瓶日志



#### 0.6.7

1. 修复微博热搜

2. 修复部落查询，单独查的时候无法查的问题

3. 修改部分数据控制的类型

4. 新增定时全体禁言的服务

5. 新增私聊coc时提醒

6. 修改“模块列表”的外观

   

#### 0.6.6

1. 新增生成随机字符串
2. 新增部落冲突的部落详细信息查询
3. 优化数据管理器的部落判断逻辑
4. 优化禁言的判断逻辑
5. 新增解除禁言，新增全体禁言的发起和解除
6. 新增特殊服务订阅接口
7. 新增部落冲突缓存机制接口



#### 0.6.5

1. 新增戳一戳与发送消息的统计
2. 独立开关模块
3. 新增闪照解除功能
4. 新增成员监控功能
5. 新增自动入群审核功能
6. 新增中午的版本提醒



#### 0.6.4

1. 彻底移除活动及相关功能
2. RPG游戏平衡性和物品调整
3. 修复回复体力导致的生命值回满的bug
4. 新增权限命令修改精神值
5. 恢复打卡功能
6. 修复零点报告的bug



#### 0.6.3

1. 迁移定时提醒，回复每日零点的统计报告
2. 新增RPG游戏的低san负收益
3. 修复RPG游戏部分已知bug
4. 新增整理背包
5. 优化RPG游戏的指令识别
6. 优化新建用户的逻辑，现在不对每个发言的人都新建用户
7. RPG游戏平衡性调整
8. 移除活动帮助
9. 搭建打卡的底层框架



#### 0.6.2

1. 修复骰子rd1时报错
2. 新增游戏备份功能
3. 新增给予所有人物品功能
4. 修复查询物品报错的问题
5. 修复培育师物品显示错误【未校验】
6. 修复赠送bug
7. 新增coc玩家、鱼情查询功能
8. 移除部分未使用、被淘汰的模块
9. 修复发送一张图片无法识别消息的问题
10. 新增戳一戳的开关，以及戳一戳可以被禁言约束
11. 删除所有信息打印
12. 修复入群欢迎不能关闭的问题，以及数据丢失后自动关闭入群欢迎

#### 0.6.1

因为框架的关系，过去的框架已经不足以支持小柒的继续开发。于是换了一个框架，换到了

[YiriMirai]: https://yiri-mirai.wybxc.cc/

1. 更换框架
2. 添加戳一戳
3. 移除打卡、活动
4. 移除自动加群审核
5. 移除RPG游戏的强化
6. RPG游戏平衡性调整

### 版本5

#### 5.7

1. 彻底更新RPG游戏
   1. 加入职业
   2. 加入附魔
   3. 加入PVE
   4. 加入成就系统
   5. 优化一系列东西
2. 支持自定义复杂回复
3. 更新自主回复逻辑

#### 5.6

1. 重构底层数据结构
2. 增加了状态记录
3. 新增入群欢迎
4. 新增模块化管理
5. 新增部落冲突信息查询
6. 新增群内自定义屏蔽词，如果拥有管理员机器人将会自动撤回消息
7. 调整文案与帮助文档
8. 调整打卡、帮助逻辑
9. 优化bot_remind逻辑
10. 优化部分代码

#### 5.5

（因为未及时上传更新，代码变动过于巨大，已经无法还原其更新内容）

1. 优化一系列代码

----------------------

追加：找到了源代码，放在0.5.6更新之后的一次提交当中

#### 5.4

1. 重构自主回复的代码
2. 修复如果群聊通过“*mute”禁言了小柒，那么临时会话也无法回复的问题。
3. 添加怪物、Boss击杀数的查看
4. 新增随机生成名字
5. 修复跑团数据莫名丢失的问题
6. 修复关键词回复概率指令失效
7. 新增申请权限，群主可以直接获取调教权限
8. 新增漂流瓶

#### 5.3

1. 优化复杂计算式的计算内核，修复两个rd加上一个数字这类表达式无法识别的bug
2. 优化鉴权系统
   1. 统一命名
   2. 优化臃肿复杂问题
   3. 现在权限不够将不会直接吃掉消息，而会回复权限不够
3. 优化基础功能的代码，进行合并

#### 5.2

1. 搜图功能开放测试群
2. 优化骰娘系统
   1. 解决臃肿复杂问题
   2. 解决层次问题
   3. 解决莫名数据清空问题
3. 新增模块使用情况统计
4. 新增关于rd的复杂表达式运算
5. 新增命令触发词自定义
6. 新增艾特回复限制，在限制模式下仅能回复艾特指令
7. 优化command指令

#### 5.1-B

是5.2版本的未完成版，因为mirai console的更新背刺，导致完全无法运行，紧急上线的修复版。

1. 修复崩溃问题
2. 新增涩图功能（未完成，已被锁定，仅测试群能用）
3. 修改鉴权系统（未完成，仅支持开启脏话的判定，回复无权限）

#### 5.1

调整整体框架，将bot.py的内容基本都移除。将两个消息处理文件groupReply和friendReply的文件着手进行了整合，整合为了一个消息处理类。进行消息的集中与统一管理。

同时在版本5并不打算引入太多的新功能。版本4基本完成了游戏的所有机制与系统，仅仅差一个主线与pve所有东西就算是大功告成。pve打算在版本5之类写完，主线打算在版本6完成。

1. 修复天气行末多空行的bug，优化爬不到数据的时候的显示逻辑。
2. 整合群聊、临时对话、朋友消息的回复。
3. 重构鉴权系统与状态鉴定系统。产生一系列的修改。
4. 重构回复逻辑，为后面单个模块的启用与关闭打下基础。
5. 删除无意义的控制台输出。

### 版本4

#### 4.9

全局：

1. 优化部分指令的调用文案，使其贴近更多人的表述习惯。

骰娘：

1. 支持骰娘全局人物模板的设置，可以把一些常用的属性模板保存起来。
2. 支持coc的理智鉴定以及理智值的自动修改。
3. 支持rd命令乘以一个常数。
4. 支持人物属性导出
5. 支持显示单个属性

游戏：

1. 新增赠送物品的功能
2. 支持批量合成、分解
3. 支持通过id查找物品，并且在读取阶段会给每个物品自动分配id
4. 修复如果通过管理员权限修改积分排行榜不更新的情况，修复兑换体力积分排行榜不更新的情况
5. 修复在合成失败后吞材料的bug，同时吞材料引起的背包无法打开的bug
6. 新增物品类型：道具
7. 展示模块，增加id的展示
8. 兑换体力由4点积分上调为5
9. 调整挖矿得到的部分物品的概率

指令：

1. 支持大小写都可以调用指令

机器人：

1. 支持自动通过好友，并且回复新人指南。

#### 4.8

1. 优化指令stc、std、sta三个指令，支持了不空格的多个属性联结
2. 新增合成、分解
3. 新增行为——挖矿
4. 修复背包不能装备的bug
5. 新增食物物品类型
6. 优化、丰富部分文案
7. 增加“小柒关机”指令的回显
8. 增加诸多装备
9. 修改帮助文档以达到正式发行的水准

#### 4.7

1. 修复围攻榜首私聊部分情况下出错的问题
2. 装备的数据逻辑优化
3. 完善血量的回复与计算机制
4. 接入BOSS的接口
5. 优化部分操作的指令，更加贴切于人类语言
6. 独立装备，让其单独成为一个文件好修改

#### 4.6

1. 支持游戏开关
3. 持无AI自动回复模式
5. 移除指令*game

#### 4.5

1. 丰富文案
2. 完善了商店购买、出售、丢弃的机制
3. 完善了装备的属性修改机制
4. 新增了给予物品的管理操作
5. 新增了游戏管理操作的日志功能
6. 约束了BUFF生效范围
7. 修复了签到不更新排行榜的问题
8. 修复了摸一摸不更新排行榜的问题
9. 修复了强化不更新排行榜的问题
10. 修改了背包的数据类型
11. 新增了四个buff：
    1. 四级进攻
    2. 四级防御
    3. 五级进攻
    4. 五级防御
12. 修改了围攻榜首的逻辑，支持私聊
13. 修改了闲逛概率，闲逛会出buff、装备
14. 修改了探险概率，探险会出buff
15. 新增了管理操作，给予所有人物品

#### 4.4

1. 修改rpg游戏的数据读取、修改逻辑
2. 丰富文案
3. 限制最大体力
4. 四级词汇、六级词汇的命令支持了四级单词和六级单词
5. 增加buff机制
6. 增加装备机制
7. 增加商店机制
8. 修改探险的概率与获得物品，正面收益下调
9. 修改闲逛的概率与获得物品，负面收益概率下调。
10. 兑换体力的积分上调
11. 修改积分结算机制
12. 增加游戏的管理权限
13. 修改排行榜结算机制
14. 新增了商店机制
15. 修改击剑概率计算公式，其与san值、攻击力、护甲、buff有关
16. 优化围攻的逻辑
17. 新增排行榜上留名的修改
18. 增加击剑被掠夺的收益，单次击剑的最高积分提高
19. 签到体力由改变变为了累计

#### 4.3

1. 丰富了文案
2. 游戏操作对临时对话支持
3. *send命令对朋友消息支持
4. 新增小柒关机的命令

#### 4.2

1. 支持积分兑换体力、探险、摸摸
2. 优化排行榜显示
3. 新增闲逛指令
4. 修复部分已知bug

#### 4.1

1. 小柒支持图片发送。
2. 关键词“好家伙”、“？”的回复有概率回复表情包。
3. 所有帮助文档修改为图片。
4. 新增RPG游戏，暂时只支持签到和击剑，排行榜的查询。
5. 新增明日方舟抽卡模拟。

### 版本3

#### 3.6

1. 支持退群指令，支持禁言小柒的指令
2. 优化多个骰子的显示逻辑
3. 支持**所有的地级市天气**查询

#### 3.5

1. 将四六级文件纳入初始化检测
2. 修改临时会话交互逻辑，支持群聊基本功能
3. 修复朋友消息，四级词汇不能回复的bug。
4. 支持骰娘功能
5. 修改群独有功能帮助的交互逻辑，提醒用户这部分命令是群聊命令
6. 增加对贡献者、管理员操作的异常处理，改变设计逻辑对贡献者和管理员操作参数不信任，依然信任主人的参数

#### 3.4

1. 修改活动的交互逻辑，在部分地方回显活动名称
2. 修改活动持续时间命令，支持小时和天
3. 新增四级词汇和六级词汇
4. 新增城市天气：沈阳、哈尔滨、长春、呼和浩特

#### 3.3

1. 修改初始化部分文件丢失不能正确修复的bug
2. 初始化新增部分数据收集
3. 新增活动功能（发布、删除、参加、退出等）

#### 3.2

1. 修改帮助文档。
2. 新增群消息命令约束条件，避免与coc机器人产生冲突。
3. 新增天气的修改，如果天气命令遇见未收录的天气，将会自动报告主人【主人必须加小柒好友才行】。
4. 增加部分屏蔽关键词

#### 3.1

版本2是对权限和聊天内容的添加与补全，版本3就是对于小柒定位——个人小助手的补充。版本2可能还存在一些未修复的bug，但是截至3.1版本位置大部分bug应该都修复了。不存在很冷门的功能。版本2因为风控问题更新的小版本已经超出原本的计划了，足足更新了12个小版本。版本3更多是私聊消息的完善，所以估计不会有太大问题。

1. 改变回复结构，增加添加回复里可以带艾特，但是不可以艾特机器人本身。（因为有高频锁死，所以想了想还是放开了这个权限。）【增加检测机制，如果发现有高频利用刷死机器人的，黑名单处理】
2. 支持添加关键词，捕获关键词回复。
3. 对于群词典大小进行限制
   1. 关键词个数限制为100
   2. 单个关键词回复个数限制为15
4. 修改连续打卡的文案，增加长时间打卡文案小柒佩服的语气。
6. 调整塔罗牌帮助文档，发现个别错别字
7. 修改帮助文案，修改掉部分行末空行
8. **发现部分情况mirai console收不到私聊信息。原因不明，但是是控制台的bug，与小柒本身无关。**
9. 引入用户的概念
10. 添加指令“每日单词 数量”获取四级词汇和六级词汇。
10. 修复远程开关脏话的指令错误
11. 新增清空每分钟回复条数的统计
12. 修复因为禁言导致小柒的崩溃
13. 支持关键词回复概率的自定义
14. AI回复概率下调至1%

### 版本2

#### 2.12

1. 修复被艾特时自主回复词莫名失效的问题
2. **发现如果登陆电脑QQ则会造成小柒被屏蔽，不能发送消息。这个bug属于console的bug，无法解决，留在此处作为警告**
3. 调整唤醒词，由小柒报告状况改为了小柒
4. 屏蔽词添加了两个功能
   1. 删除屏蔽词
   2. 查看屏蔽词
5. 启用了脏话功能
6. 修复如果没有关闭打卡计划而被踢出群聊，造成的崩溃。
7. 新增权限查询指令：我的权限

#### 2.11

1. 再次调整回复概率：（不得不说QQ风控是一个令人头疼的问题，已经想尽办法应对了）
   1. 词集回复由50%调回100%
   2. AI部分的回复由20%下调为5%
   3. 每分钟词集回复不能超过10条（合计6秒一次）
2. 权限划分优化，管理员部分权限给主人，贡献者部分权限给管理员。
3. 微博热搜条数由15条调整为微博顶置+5条
4. 修改所有人都完成了打卡的显示
5. 添加自主回复词“帮助”

#### 2.10

1. 关键词功能：
   1. 对于自定义关键词回复添加*分隔，以便于添加含有空格的关键词
   2. 修复对于回复词被删空的时候回复崩溃的bug
   3. 对于关键词进行按照群的划分
   4. 降低词集回复概率，由100%降低为50%
2. 其他bug修复：
   1. 修复朋友消息运势失效的问题
   2. 修复百度热搜手机版结尾多一个空行的问题
3. 新增功能：
   1. 新增对于临时会话进行处理，统一回复需要添加好友。
   2. 小柒的权限分为了四级：用户、贡献者计划、管理员、主人。但是现在未对四级权限进行操作指令的划分，各个权限等级，一切还是按照上个版本的权限。后续将会逐步放开对贡献者计划的管理，转而加强对管理员的控制。
   3. 文件的自我修复，对于部分配置文件自我修复

#### 2.9

1. 调低回复概率
2. 调整打卡文本显示
3. 增加部分屏蔽词
4. 添加删除管理员的功能
5. 添加查看指令
   1. 查看贡献者计划
   2. 查看黑名单 人
   3. 查看黑名单 群
6. 添加新增屏蔽词的功能，避免青云客AI奇怪回复
7. 新增自定义关键词回复，可以帮助小柒完成一些关键词自主回复
8. 新增天气词库——济南、东营、贵阳

#### 2.8

1. 修复因为接入神经网络，引起的@部分情况下关键词回复失效
2. 修复帮助文档的部分文字错误
3. 修改打卡日志格式
4. 增加屏蔽词，防止神经网络色情回复
5. 修复朋友回复，指令失效的问题
6. 修复塔罗牌，牌阵显示错误的bug
7. 调整自动回复概率，之前的自动回复概率偏高

#### 2.7

1. 打卡部分新增功能
   1. 锁定打卡计划，可以禁止退出和加入
   2. 解锁打卡计划
   3. 开启打卡计划提醒
   4. 关闭打卡计划提醒
   5. 开启打卡计划总结
   6. 关闭打卡计划总结
   7. 在打卡群发送打卡情况无需添加群号
   8. 对于退出群聊的人，进行每天自动清理（垃圾回收机制）
   9. 打卡的天数进行累计统计
   10. 修改打卡的帮助文档
   11. 对于打卡新增日志功能
2. 爬虫部分新增功能
   1. 百度热搜
3. 智能回复部分
   1. 接入 [青云客网络](http://api.qingyunke.com/) 的自动回复，但是感觉仍然有一些问题，于我预期的小柒性格不符合

（2.8版本应该会修一系列bug，这个版本引入了较多的新功能）

#### 2.6

1. 修复0点发送测试群信息崩溃的bug
2. 修复因为日志导致的小柒提示程序崩溃
3. 修改塔罗牌排版，统一电脑与手机的显示区别
4. 修复控信息导致的群回复失效bug

#### 2.5

1. 修复部分文案错误
2. 修改“打卡信息”指令的回复，添加昵称
3. 修改非指令回复的框架，将其独立出来，方便添加神经网路

#### 2.4

1. 修复+1莫名失效的bug
2. 修复零点提醒的bug
3. 修复重置打卡数据，莫名崩溃的bug
4. 增加管理员操作的日志记录

#### 2.3

修复运势bug，修复部分打卡bug

暂未解决的bug：

1. 加一部分情况下失效
2. 提醒打卡有问题，莫名会出现定时崩溃，暂不清楚原因

#### 2.2

修改运势的概率曲线，由原来的均值

$$
50 \sqrt(2)
$$

变为当前的

$$
50
$$

新增，如果零点仍然没有打卡，则提醒其未打卡。

#### 2.1

重新构造保存的数据结构，使其更加满足高内聚低耦合的设计思想。尽量减小各个模块之间的依赖。并且精简bot运行的主程序，是阅读代码时的回复逻辑能够看得更加清楚。

*本次更新几乎完全改变了文件结构*

同时增加日志，来监听小柒的运行状况。是否出现崩溃。

### 版本1

#### 1.9

新增微博热搜爬虫

计划在下一个版本完成一次大更新。现有文件架构已经出现了一些问题

#### 1.8

修复部分bug，新增与lorina的联动回复。新增“骂我一句”

#### 1.7

减小“？”的回复概率

新增0点的自动重置打卡情况

#### 1.6

修复管理员私聊部分回复无响应定的bug

新增拉入黑名单的限制，不能将管理员拉入黑名单

#### 1.5

修复管理员不能打卡的bug

#### 1.4

对自动+1的bug修复

修复情话/文摘的小bug

将运势改为一天一测

#### 1.3

新增对黑名单的远程处理

#### 1.2

新增命令“重新加载配置文件”，报告小柒的运行状况

#### 1.1

完成了打卡所有功能，增加了添加/删除 文摘/情话

新增伴生进程，定时发送信息

增加部分管理员命令（对成员属性的操作、版本信息的操作）

#### 1.0

小柒重新换了架构，重新组织了文件。新增了许多保存数据的文件。

新增了打卡功能

划分了三类权限

新增了一些管理员命令

### 版本0

#### 0.6

小柒学会了发送情话、文摘、自动+1

#### 0.5

小柒试图学会发送图片，但是失败

#### 0.4

小柒学会了测运势，帮助，硬币，色子/骰子

#### 0.3

小柒学会了天气查询指令

#### 0.2

小柒可以回复关键词"你好"

#### 0.1

小柒可以在收到消息回复“你好，世界！”